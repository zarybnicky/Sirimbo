{% extends "Layout.twig" %}

{% block content %}
  <div class="container">
    <form action="" method="get">
      <table>
        <tr>
          <td>Uživatelé:</td>
          <td>{{ select('status', statusOptions, status ? status : 'all') }}</td>
        </tr>
        <tr>
          <td>Skupina:</td>
          <td>{{ select('skupina', skupinyOptions, skupina ? skupina : 'all') }}</td>
        </tr>
        <tr>
          <td>Oprávnění:</td>
          <td>{{ select('group', groupOptions, group ? group : 'all') }}</td>
        </tr>
        <tr>
          <td>Řadit podle:</td>
          <td>{{ select('sort', sortOptions, sort ? sort : 'prijmeni') }}</td>
        </tr>
        <tr>
          <td>Zobrazení:</td>
          <td>{{ select('view', {'info': 'informace', 'status': 'status uživatele'}, view ? view : 'info') }}</td>
        </tr>
        <tr>
          <td colspan="2"><button class="btn btn-primary">Filtrovat</button></td>
        </tr>
      </table>
    </form>

    <form action="" method="POST">
      <a href="/admin/users/add" class="btn btn-outline-primary">Nový uživatel</a>
      <a href="/admin/users/duplicate" class="btn btn-outline-primary">Duplicitní uživatelé</a>
      <a href="/admin/users/unconfirmed" class="btn btn-outline-primary">Nepotvrzení uživatelé</a>
      <a href="/admin/users/statistiky" class="btn btn-outline-primary">Statistiky</a>
      <a href="/admin/users/getMsmtCsv" class="btn btn-outline-primary">MŠMT export</a>
      {% if view == 'status' %}
        <button class="btn btn-primary" name="action" value="save">Uložit změny</button>
      {% endif %}
      <br>

      {% if not data %}
        {{ notice('Žádní takoví uživatelé') }}
      {% else %}
        <table style="width:100%">
          <tr>
            <th></th>
            <th></th>
            <th>Jméno</th>
            {% if view == 'status' %}
              <th></th>
              <th>Oprávnění</th>
              <th>Systémový<br/>uživatel</th>
              <th>Ban</th>
            {% else %}
              <th></th>
              <th>Oprávnění</th>
              <th>Datum<br>narození</th>
              <th>Variabilní<br>symbol</th>
            {% endif %}
          </tr>
          {% for row in data %}
            <tr>
              <td>{{ row.checkBox | raw }}</td>
              <td>{{ startIndex + loop.index }}.</td>
              <td>{{ row.user.fullName }}</td>
              {% if view == 'status' %}
                <td>
                  <input type='hidden' name='save[]' value='{{ row.user.id }}'>
                  {{ select(row.user.id ~ '-skupina', onlySkupinyOptions, row.skupina.id) }}
                </td>
                <td>{{ row.groupInfo }}</td>
                <td class="text-center">
                  {{ checkbox(row.user.id ~ '-system', '1', row.user.system) }}
                </td>
                <td class="text-center">
                  {{ checkbox(row.user.id ~ '-ban', '+', row.user.ban) }}
                </td>
              {% else %}
                <td>
                  <div class="box" title="{{ row.skupina.description }}"
                       style="background-color:{{ row.skupina.color }}"></div>
                </td>
                <td>{{ row.groupInfo }}</td>
                <td>{{ row.birthDate }}</td>
                <td>{{ row.varSymbol }}</td>
              {% endif %}
            </tr>
          {% endfor %}
        </table>
      {% endif %}
    </form>
    <div style="text-align:center">{{ navigation | raw }}</div>
  </div>
{% endblock %}

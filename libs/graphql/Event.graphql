fragment Event on Event {
  __typename
  id
  since
  until
  summary
  description
  descriptionMember
  filesLegacy
  name
  capacity
  remainingSpots
  locationText
  isLocked
  isVisible
  isPublic
  enableNotes
}

fragment EventItem on AttendeeUser {
  id
  notes
  user {
    uJmeno
    uPrijmeni
    uRodneCislo
    uTelefon
    uEmail
  }
}

fragment EventWithItems on Event {
  ...Event
  attendeeExternals {
    nodes {
      firstName
      lastName
    }
  }
  attendeeUsers {
    nodes {
      notes
      user {
        uId
        uJmeno
        uPrijmeni
        uNarozeni
        uTelefon
        uEmail
        uRodneCislo
      }
    }
  }
}

query Event($id: BigInt!) {
  event(id: $id) {
    ...EventWithItems
  }
}

query EventList($first: Int, $offset: Int, $visible: Boolean) {
  events(first: $first, offset: $offset, orderBy: [SINCE_DESC], condition: {isVisible: $visible}) {
    totalCount
    nodes {
      ...EventWithItems
    }
  }
}

mutation ToggleEventVisible($id: BigInt!, $visible: Boolean!) {
  updateEvent(input: {id: $id, patch: {isVisible: $visible}}) {
    event {
      id
    }
  }
}

mutation CreateEvent($input: EventInput!) {
  createEvent(input: {event: $input}) {
    event {
      id
    }
  }
}

mutation UpdateEvent($id: BigInt!, $patch: EventPatch!) {
  updateEvent(input: {id: $id, patch: $patch}) {
    __typename
  }
}

mutation DeleteEvent($id: BigInt!) {
  deleteEvent(input: {id: $id}) {
    __typename
  }
}

fragment MyEvent on Event {
  ...EventWithItems
}

query MyEvents {
  events(condition: {isVisible: true, isFuture: true, type: CAMP}, orderBy: [SINCE_ASC]) {
    nodes {
      ...MyEvent
    }
  }
}

mutation CreateAttendeeExternal($input: CreateParticipationExternalInput!) {
  createParticipationExternal(input: $input) {
    __typename
  }
}

mutation CreateParticipation($input: CreateParticipationInput!) {
  createParticipation(input: $input) {
    __typename
  }
}

mutation CancelParticipation($input: CancelParticipationInput!) {
  cancelParticipation(input: $input) {
    __typename
  }
}
